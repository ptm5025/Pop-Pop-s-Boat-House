<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ocean Pines Coastal Weather - For Pop Pop</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 50%, #00cec9 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .hero-photo {
            margin: 20px 0;
            text-align: center;
        }

        .hero-placeholder, .hero-image {
            width: 100%;
            max-width: 600px;
            height: 300px;
            margin: 0 auto;
            border-radius: 20px;
            display: block;
        }

        .hero-placeholder {
            background: linear-gradient(45deg, #ddd, #eee);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            border: 3px dashed #aaa;
            font-size: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-direction: column;
        }

        .hero-placeholder:hover {
            background: linear-gradient(45deg, #ccc, #ddd);
            transform: scale(1.02);
        }

        .hero-image {
            object-fit: cover;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
        }

        .hero-image:hover {
            transform: scale(1.02);
        }

        .second-photo {
            margin: 20px 0;
            text-align: center;
        }

        .second-placeholder, .second-image {
            width: 300px;
            height: 200px;
            margin: 0 auto;
            border-radius: 15px;
            display: block;
        }

        .second-placeholder {
            background: linear-gradient(45deg, #ddd, #eee);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            border: 3px dashed #aaa;
            font-size: 14px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-direction: column;
        }

        .second-placeholder:hover {
            background: linear-gradient(45deg, #ccc, #ddd);
            transform: scale(1.05);
        }

        .second-image {
            object-fit: cover;
            box-shadow: 0 6px 24px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s ease;
        }

        .second-image:hover {
            transform: scale(1.05);
        }

        .location-title {
            font-size: 2.5em;
            color: #2d3436;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtitle {
            font-size: 1.2em;
            color: #636e72;
            margin-bottom: 15px;
        }

        .last-updated {
            font-size: 0.9em;
            color: #74b9ff;
            font-weight: bold;
        }

        .weather-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .weather-card {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .weather-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .current-weather {
            grid-column: 1 / -1;
            text-align: center;
        }

        .marine-section {
            grid-column: 1 / -1;
        }

        .marine-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .marine-card {
            background: rgba(0, 206, 201, 0.1);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid rgba(0, 206, 201, 0.3);
            text-align: center;
            transition: all 0.3s ease;
        }

        .marine-card:hover {
            background: rgba(0, 206, 201, 0.2);
            transform: scale(1.03);
        }

        .marine-title {
            font-size: 1.8em;
            color: #2d3436;
            margin-bottom: 20px;
            text-align: center;
        }

        .temp-main {
            font-size: 4em;
            font-weight: bold;
            color: #0984e3;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .weather-description {
            font-size: 1.5em;
            color: #636e72;
            margin-bottom: 20px;
            text-transform: capitalize;
        }

        .weather-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .detail-item {
            text-align: center;
            padding: 15px;
            background: rgba(116, 185, 255, 0.1);
            border-radius: 15px;
            border: 2px solid rgba(116, 185, 255, 0.3);
        }

        .detail-label {
            font-size: 0.9em;
            color: #636e72;
            margin-bottom: 5px;
        }

        .detail-value {
            font-size: 1.3em;
            font-weight: bold;
            color: #2d3436;
        }

        .marine-detail-item {
            text-align: center;
            padding: 15px;
            background: rgba(0, 206, 201, 0.1);
            border-radius: 15px;
            border: 2px solid rgba(0, 206, 201, 0.3);
        }

        .tides-container {
            background: rgba(0, 206, 201, 0.1);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid rgba(0, 206, 201, 0.3);
            margin-top: 20px;
        }

        .tide-times {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .tide-time {
            text-align: center;
            padding: 15px;
            background: rgba(116, 185, 255, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(116, 185, 255, 0.3);
        }

        .forecast-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            margin-bottom: 30px;
        }

        .forecast-title {
            font-size: 1.8em;
            color: #2d3436;
            margin-bottom: 20px;
            text-align: center;
        }

        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .forecast-day {
            background: rgba(116, 185, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid rgba(116, 185, 255, 0.3);
            transition: all 0.3s ease;
        }

        .forecast-day:hover {
            background: rgba(116, 185, 255, 0.2);
            transform: scale(1.05);
        }

        .day-name {
            font-weight: bold;
            color: #2d3436;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .day-temp {
            font-size: 1.4em;
            color: #0984e3;
            margin: 10px 0;
        }

        .day-desc {
            color: #636e72;
            font-size: 0.9em;
        }

        .radar-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .radar-title {
            font-size: 1.8em;
            color: #2d3436;
            margin-bottom: 20px;
            text-align: center;
        }

        .radar-container {
            width: 100%;
            height: 400px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            background: #f0f0f0;
        }

        .radar-iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 15px;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            font-size: 1.2em;
            color: #74b9ff;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #74b9ff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin-right: 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .refresh-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #74b9ff;
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 1.5em;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(116, 185, 255, 0.3);
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            background: #0984e3;
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(116, 185, 255, 0.4);
        }

        .error {
            background: #ff7675;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .wave-height {
            font-size: 2em;
            color: #00cec9;
            font-weight: bold;
        }

        .tide-indicator {
            font-size: 1.5em;
            margin: 10px 0;
        }

        .high-tide {
            color: #0984e3;
        }

        .low-tide {
            color: #e17055;
        }

        @media (max-width: 768px) {
            .location-title {
                font-size: 2em;
            }
            
            .temp-main {
                font-size: 3em;
            }
            
            .hero-placeholder, .hero-image {
                max-width: 100%;
                height: 250px;
            }
            
            .second-placeholder, .second-image {
                width: 90%;
                max-width: 300px;
                height: 180px;
            }

            .marine-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="location-title">‚öì Pop Pop's Boat House</h1>
            <p class="subtitle">Ocean Pines Weather Station</p>
            
            <!-- Hero Photo Section -->
            <div class="hero-photo">
                <img src="sunset.jpg" alt="Pop Pop's sunset photo" class="hero-image">
            </div>
            
            <!-- Second Photo Section -->
            <div class="second-photo">
                <img src="Mom Dad Boat.jpg" alt="Family memories" class="second-image">
            </div>
            
            <div class="last-updated" id="lastUpdated">Loading coastal weather data...</div>
        </div>

        <div class="weather-grid">
            <div class="weather-card current-weather" id="currentWeather">
                <div class="loading">
                    <div class="spinner"></div>
                    Loading current weather...
                </div>
            </div>

            <div class="weather-card marine-section">
                <h2 class="marine-title">üåä Marine Conditions</h2>
                <div class="marine-grid" id="marineGrid">
                    <div class="loading">
                        <div class="spinner"></div>
                        Loading marine data...
                    </div>
                </div>
                
                <div class="tides-container" id="tidesContainer">
                    <h3 style="text-align: center; margin-bottom: 15px; color: #2d3436;">üåä Today's Tides (Ocean City)</h3>
                    <div class="tide-times" id="tideTimes">
                        <div class="loading">
                            <div class="spinner"></div>
                            Loading tide data...
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="forecast-container" id="forecastContainer">
            <h2 class="forecast-title">üìÖ 7-Day Weather & Marine Forecast</h2>
            <div class="forecast-grid" id="forecastGrid">
                <div class="loading">
                    <div class="spinner"></div>
                    Loading forecast...
                </div>
            </div>
        </div>

        <div class="radar-section">
            <h2 class="radar-title">üå¶Ô∏è Weather Radar & Marine Charts</h2>
            <div class="radar-container">
                <iframe 
                    class="radar-iframe" 
                    src="https://embed.windy.com/embed.html?type=map&location=coordinates&metricRain=default&metricTemp=default&metricWind=default&zoom=10&overlay=waves&product=ecmwf&level=surface&lat=38.39&lon=-75.15"
                    frameborder="0">
                </iframe>
            </div>
            <p style="text-align: center; margin-top: 15px; color: #636e72; font-size: 0.9em;">
                üí° Click the layers button in the radar to switch between rain, waves, wind, and temperature
            </p>
        </div>
    </div>

    <button class="refresh-btn" onclick="refreshWeather()" title="Refresh Weather Data">
        üîÑ
    </button>

    <script>
        // Ocean Pines coordinates
        const LATITUDE = 38.39;
        const LONGITUDE = -75.15;
        
        // Ocean City NOAA tide station
        const TIDE_STATION = '8570283';

        // Weather and marine data storage
        let weatherData = {};
        let marineData = {};
        let tideData = {};

        // Initialize the weather station
        async function initWeatherStation() {
            console.log('Initializing Ocean Pines Coastal Weather Station...');
            await Promise.all([
                loadWeatherData(),
                loadMarineData(),
                loadTideData()
            ]);
            
            // Auto-refresh every 10 minutes
            setInterval(refreshWeather, 10 * 60 * 1000);
        }

        // Load weather data from Open-Meteo API
        async function loadWeatherData() {
            try {
                updateLastUpdated('Loading fresh weather data...');
                
                const currentResponse = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${LATITUDE}&longitude=${LONGITUDE}&current=temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code,wind_speed_10m,wind_direction_10m,pressure_msl,visibility&hourly=temperature_2m,relative_humidity_2m,precipitation_probability,weather_code,visibility&daily=weather_code,temperature_2m_max,temperature_2m_min,precipitation_sum,wind_speed_10m_max&temperature_unit=fahrenheit&wind_speed_unit=mph&precipitation_unit=inch&timezone=America/New_York`);
                
                if (!currentResponse.ok) {
                    throw new Error(`Weather API responded with status: ${currentResponse.status}`);
                }
                
                weatherData = await currentResponse.json();
                console.log('Weather data loaded successfully');
                
                renderCurrentWeather();
                renderForecast();
                
            } catch (error) {
                console.error('Error loading weather data:', error);
                showError('currentWeather', 'Unable to load weather data. Please check your internet connection and try again.');
            }
        }

        // Load marine data from Open-Meteo Marine API
        async function loadMarineData() {
            try {
                const marineResponse = await fetch(`https://api.open-meteo.com/v1/marine?latitude=${LATITUDE}&longitude=${LONGITUDE}&current=wave_height,wave_direction,wave_period,wind_wave_height,wind_wave_direction,wind_wave_period,swell_wave_height,swell_wave_direction,swell_wave_period,ocean_current_velocity,ocean_current_direction&hourly=wave_height,swell_wave_height,ocean_current_velocity&daily=wave_height_max,swell_wave_height_max&timezone=America/New_York`);
                
                if (!marineResponse.ok) {
                    throw new Error(`Marine API responded with status: ${marineResponse.status}`);
                }
                
                marineData = await marineResponse.json();
                console.log('Marine data loaded successfully');
                
                renderMarineConditions();
                
            } catch (error) {
                console.error('Error loading marine data:', error);
                showError('marineGrid', 'Unable to load marine data at this time.');
            }
        }

        // Load tide data using a CORS proxy for NOAA API
        async function loadTideData() {
            try {
                const today = new Date();
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                
                const todayStr = formatDateForNOAA(today);
                const tomorrowStr = formatDateForNOAA(tomorrow);
                
                // Using a CORS proxy to access NOAA API
                const proxyUrl = 'https://api.allorigins.win/raw?url=';
                const noaaUrl = `https://api.tidesandcurrents.noaa.gov/api/prod/datagetter?begin_date=${todayStr}&end_date=${tomorrowStr}&station=${TIDE_STATION}&product=predictions&datum=MLLW&time_zone=lst_ldt&interval=hilo&units=english&format=json`;
                
                const tideResponse = await fetch(proxyUrl + encodeURIComponent(noaaUrl));
                
                if (!tideResponse.ok) {
                    throw new Error(`Tide API responded with status: ${tideResponse.status}`);
                }
                
                tideData = await tideResponse.json();
                console.log('Tide data loaded successfully:', tideData);
                
                renderTideData();
                
            } catch (error) {
                console.error('Error loading tide data:', error);
                // Fallback to sample tide data for demonstration
                showSampleTideData();
            }
        }

        // Show sample tide data if API fails
        function showSampleTideData() {
            const tideTimesElement = document.getElementById('tideTimes');
            const now = new Date();
            
            // Generate realistic sample tide times for Ocean City
            const sampleTides = [
                { time: new Date(now.getFullYear(), now.getMonth(), now.getDate(), 6, 15), type: 'Low', height: 0.8 },
                { time: new Date(now.getFullYear(), now.getMonth(), now.getDate(), 12, 30), type: 'High', height: 3.2 },
                { time: new Date(now.getFullYear(), now.getMonth(), now.getDate(), 18, 45), type: 'Low', height: 0.5 },
                { time: new Date(now.getFullYear(), now.getMonth(), now.getDate(), 24, 0), type: 'High', height: 3.1 }
            ].filter(tide => tide.time > now); // Only show future tides
            
            const tidesHTML = sampleTides.map(tide => {
                const isHigh = tide.type === 'High';
                
                return `
                    <div class="tide-time">
                        <div class="tide-indicator ${isHigh ? 'high-tide' : 'low-tide'}">
                            ${isHigh ? '‚¨ÜÔ∏è' : '‚¨áÔ∏è'} ${tide.type.toUpperCase()} TIDE
                        </div>
                        <div style="font-size: 1.2em; font-weight: bold; color: #2d3436; margin: 5px 0;">
                            ${tide.time.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })}
                        </div>
                        <div style="color: #636e72;">
                            ${tide.height.toFixed(1)} ft
                        </div>
                    </div>
                `;
            }).join('');
            
            tideTimesElement.innerHTML = tidesHTML + 
                '<div style="text-align: center; margin-top: 10px; font-size: 0.8em; color: #74b9ff;">Sample data - NOAA API temporarily unavailable</div>';
        }

        // Render current weather conditions
        function renderCurrentWeather() {
            const current = weatherData.current;
            const currentElement = document.getElementById('currentWeather');
            
            if (!current) {
                showError('currentWeather', 'Current weather data not available');
                return;
            }
            
            const weatherDescription = getWeatherDescription(current.weather_code);
            const weatherIcon = getWeatherIcon(current.weather_code);
            
            currentElement.innerHTML = `
                <div style="font-size: 2em; margin-bottom: 10px;">${weatherIcon}</div>
                <div class="temp-main">${Math.round(current.temperature_2m)}¬∞F</div>
                <div class="weather-description">${weatherDescription}</div>
                <div class="weather-details">
                    <div class="detail-item">
                        <div class="detail-label">Feels Like</div>
                        <div class="detail-value">${Math.round(current.apparent_temperature)}¬∞F</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Humidity</div>
                        <div class="detail-value">${current.relative_humidity_2m}%</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Wind Speed</div>
                        <div class="detail-value">${Math.round(current.wind_speed_10m)} mph</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Wind Direction</div>
                        <div class="detail-value">${getWindDirection(current.wind_direction_10m)}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Pressure</div>
                        <div class="detail-value">${Math.round(current.pressure_msl * 0.02953)} in</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Visibility</div>
                        <div class="detail-value">${Math.round(current.visibility * 0.000621371)} mi</div>
                    </div>
                </div>
            `;
        }

        // Render marine conditions
        function renderMarineConditions() {
            const current = marineData.current;
            const marineGrid = document.getElementById('marineGrid');
            
            if (!current) {
                showError('marineGrid', 'Marine data not available');
                return;
            }
            
            const waveHeight = current.wave_height ? current.wave_height : 0;
            const swellHeight = current.swell_wave_height ? current.swell_wave_height : 0;
            const windWaveHeight = current.wind_wave_height ? current.wind_wave_height : 0;
            const currentSpeed = current.ocean_current_velocity ? current.ocean_current_velocity : 0;
            
            marineGrid.innerHTML = `
                <div class="marine-card">
                    <div class="detail-label">üåä Wave Height</div>
                    <div class="wave-height">${waveHeight.toFixed(1)} ft</div>
                    <div style="font-size: 0.9em; color: #636e72; margin-top: 5px;">
                        Direction: ${getWindDirection(current.wave_direction || 0)}
                    </div>
                </div>
                <div class="marine-card">
                    <div class="detail-label">üèÑ‚Äç‚ôÇÔ∏è Swell Conditions</div>
                    <div class="detail-value">${swellHeight.toFixed(1)} ft</div>
                    <div style="font-size: 0.9em; color: #636e72; margin-top: 5px;">
                        ${current.swell_wave_period ? `${current.swell_wave_period.toFixed(0)}s period` : 'N/A'}
                    </div>
                </div>
                <div class="marine-card">
                    <div class="detail-label">üí® Wind Waves</div>
                    <div class="detail-value">${windWaveHeight.toFixed(1)} ft</div>
                    <div style="font-size: 0.9em; color: #636e72; margin-top: 5px;">
                        ${current.wind_wave_period ? `${current.wind_wave_period.toFixed(0)}s period` : 'N/A'}
                    </div>
                </div>
                <div class="marine-card">
                    <div class="detail-label">üåä Ocean Current</div>
                    <div class="detail-value">${currentSpeed.toFixed(1)} kt</div>
                    <div style="font-size: 0.9em; color: #636e72; margin-top: 5px;">
                        Direction: ${getWindDirection(current.ocean_current_direction || 0)}
                    </div>
                </div>
                <div class="marine-card">
                    <div class="detail-label">üìä Sea State</div>
                    <div class="detail-value">${getSeaState(waveHeight)}</div>
                    <div style="font-size: 0.9em; color: #636e72; margin-top: 5px;">
                        ${getSeaStateDescription(waveHeight)}
                    </div>
                </div>
                <div class="marine-card">
                    <div class="detail-label">üéØ Best Conditions</div>
                    <div class="detail-value">${getBestMarineActivity(waveHeight, current.wind_speed_10m)}</div>
                    <div style="font-size: 0.9em; color: #636e72; margin-top: 5px;">
                        Based on current conditions
                    </div>
                </div>
            `;
        }

        // Render tide data
        function renderTideData() {
            const tideTimesElement = document.getElementById('tideTimes');
            
            if (!tideData.predictions || tideData.predictions.length === 0) {
                showError('tideTimes', 'Tide data not available');
                return;
            }
            
            // Get today's tides
            const today = new Date();
            const todayTides = tideData.predictions.filter(prediction => {
                const tideDate = new Date(prediction.t);
                return tideDate.toDateString() === today.toDateString();
            });
            
            if (todayTides.length === 0) {
                tideTimesElement.innerHTML = '<div style="text-align: center;">No tide data available for today</div>';
                return;
            }
            
            const tidesHTML = todayTides.map(tide => {
                const time = new Date(tide.t);
                const height = parseFloat(tide.v);
                const type = tide.type.toLowerCase();
                const isHigh = type.includes('high');
                
                return `
                    <div class="tide-time">
                        <div class="tide-indicator ${isHigh ? 'high-tide' : 'low-tide'}">
                            ${isHigh ? '‚¨ÜÔ∏è' : '‚¨áÔ∏è'} ${type.toUpperCase()} TIDE
                        </div>
                        <div style="font-size: 1.2em; font-weight: bold; color: #2d3436; margin: 5px 0;">
                            ${time.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })}
                        </div>
                        <div style="color: #636e72;">
                            ${height.toFixed(2)} ft
                        </div>
                    </div>
                `;
            }).join('');
            
            tideTimesElement.innerHTML = tidesHTML;
        }

        // Render 7-day forecast with marine data
        function renderForecast() {
            const daily = weatherData.daily;
            const marinDaily = marineData.daily;
            const forecastGrid = document.getElementById('forecastGrid');
            
            if (!daily) {
                showError('forecastGrid', 'Forecast data not available');
                return;
            }
            
            const forecastHTML = daily.time.slice(0, 7).map((date, index) => {
                const dayName = getDayName(date);
                const weatherIcon = getWeatherIcon(daily.weather_code[index]);
                const maxTemp = Math.round(daily.temperature_2m_max[index]);
                const minTemp = Math.round(daily.temperature_2m_min[index]);
                const description = getWeatherDescription(daily.weather_code[index]);
                const maxWaveHeight = marinDaily?.wave_height_max?.[index];
                const maxSwellHeight = marinDaily?.swell_wave_height_max?.[index];
                
                return `
                    <div class="forecast-day">
                        <div class="day-name">${dayName}</div>
                        <div style="font-size: 1.5em; margin: 10px 0;">${weatherIcon}</div>
                        <div class="day-temp">${maxTemp}¬∞ / ${minTemp}¬∞</div>
                        <div class="day-desc">${description}</div>
                        <div style="margin-top: 10px; font-size: 0.8em; color: #74b9ff;">
                            üíß ${daily.precipitation_sum[index]}" rain
                        </div>
                        ${maxWaveHeight ? `
                        <div style="margin-top: 5px; font-size: 0.8em; color: #00cec9;">
                        
